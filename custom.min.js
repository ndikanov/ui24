var BM_CUSTOM=Class.create(Widget,{initialize:function($super,b){$super(b);this.widgetName="BM_CUSTOM";this.h=BM_BOT_H;this.w=screenWidth-BM_SO_W;this.setAnchors(0,measures.topWidgetHeight+BM_TOP_H,BM_SO_W,null);this.mode=0;this.initWidgets();this.setMode(0);this.onResize()},onResize:function(){this.mtkplayer.setAnchors(this.w/2,0,0,0);1680>this.w?this.mtkplayer.hide():this.mtkplayer.show();1680>this.w?this.player.setAnchors(0,0,0,0):this.player.setAnchors(0,0,this.w/2,0)},onShow:function(){this.upd();this.mtkplayer.onShow();this.player.onShow()},upd:function(){this.player.calcGeometry();this.player.show();this.mtkplayer.show()},setMode:function(a){this.mode=a;regUpdate(this)},initWidgets:function(){this.mtkplayer=new BM_MTK_PLAY(this);this.player=new BM_PLAYER(this)},paint:function(){ctx.fillStyle=color.eqBg;ctx.fillRect(this.offsetX,0,this.w,this.h)}}),BM_PLAYER=Class.create(Widget,{initialize:function($super,b){$super(b);this.name="BM_PLAYER";this.y=measures.topWidgetHeight;this.color=color.media;this.mode=0;this.initWidgets();player2track=this},setMode:function(a){this.mode=a;regUpdate(this)},initWidgets:function(){this.regKey("settings.playMode");this.regKey("settings.cue");this.regKey("var.present");var a=this;this.SWITCH=new SWITCHBOX(this);this.SWITCH.setItems([lang.PLAYER,lang.PADS]);this.SWITCH.setItemWidth(70);this.SWITCH.color=color.media;this.SWITCH.hide();this.RENAME=new MENUBUTTON(this);this.RENAME.text=lang.RENAME;this.RENAME.setAnchors(null,null,300,5);this.RENAME.w=90;this.RENAME.getState=function(){this.disabled="Recordings"!=a.PLISTS.selItem()};this.RENAME.onPress=function(){if("Recordings"==a.PLISTS.selItem()){var b=a.FLIST.selItem()||"";b&&(editOk.valueFunc=function(){var a=editBox2.value;a&&b!=a&&sendMessage("RENAME^"+b+"^"+a)},showEditBox2(lang.RENAME+" ("+b+")",b,60))}};this.ORDER=new SWITCHBOX(this);this.ORDER.setAnchors(10,null,null,5);this.ORDER.color=color.media;this.ORDER.setItems([lang.MANUAL,lang.AUTO]);this.ORDER.setItemWidth(80);this.ORDER.getState=function(){switch(getValue("settings.playMode")){case 0:this.state=0;break;case 1:this.state=0;break;case 2:this.state=1;break;case 3:this.state=1}
this.text=this.state?lang.AUTO:lang.MANUAL};this.ORDER.valueFunc=function(){isBlocked("player")?showPopupMsg(lang.LOCKED,800):(setValue("settings.playMode",0==this.state?0:3),regUpdate(a))};this.TIME=new TIME_LABEL(this);this.TIME.regKey("var.currentTrackPos");this.SEEKBAR=new SEEKBAR(this);this.SEEKBAR.setPos(10,66);this.SEEKBAR.regKey("var.currentTrackPos");this.SEEKBAR.ondown=function(){a.TIME.setMode(1)};this.SEEKBAR.onup=function(){a.TIME.setMode(0)};this.SEEKBAR.onmove=function(b){a.TIME.setValue2(b);regUpdate(a.TIME)};this.SEEKBAR.onChange=function(a){isBlocked("player")?showPopupMsg(lang.LOCKED,800):sendMessage(E_COMMANDS.MEDIA_JUMP_TO+"^"+a)};this.PREV=new Button(this);this.PREV.setImages(res.player_prev_off,res.player_prev_on);this.PREV.opaque=!1;this.PREV.disabledHide=!1;this.PREV.getState=function(){this.disabled=0==getValue("var.present")};this.PREV.valueFunc=function(){EMULATE?showPopupMsg(lang.DEMO_VERSION):isBlocked("player")?showPopupMsg(lang.LOCKED,800):sendMessage(E_COMMANDS.MEDIA_PREV)};this.PLAY=new CheckBox(this);this.PLAY.setImages(res.player_play,res.player_pause);this.PLAY.opaque=!1;this.PLAY.disabledHide=!1;this.PLAY.getState=function(){this.state=2==getValue("var.currentState")?1:0;this.disabled=0==getValue("var.present")};this.PLAY.onToggleUp=function(){if(EMULATE)showPopupMsg(lang.DEMO_VERSION);else if(isBlocked("player"))showPopupMsg(lang.LOCKED,800);else{var b=a.FLIST.selItem(),d=a.PLISTS.selItem(),e=getValue("var.currentTrack"),f=getValue("var.currentPlaylist");if(null!=b&&b!=e){if(null==d||0==d.length)d=f;null!=d&&0!=d.length&&null!=b&&0!=b.length&&sendMessage(E_COMMANDS.MEDIA_SWITCH_TRACK+"^"+d+"^"+b)}else getValue("settings.cue")&&sendMessage(E_COMMANDS.MEDIA_NEXT);sendMessage(E_COMMANDS.MEDIA_PLAY)}};this.PLAY.onToggleDown=function(){isBlocked("player")?showPopupMsg(lang.LOCKED,800):sendMessage(E_COMMANDS.MEDIA_PAUSE)};this.NEXT=new Button(this);this.NEXT.setImages(res.player_next_off,res.player_next_on);this.NEXT.opaque=!1;this.NEXT.disabledHide=!1;this.NEXT.getState=function(){this.disabled=0==getValue("var.present")};this.NEXT.onPress=function(){EMULATE?showPopupMsg(lang.DEMO_VERSION):isBlocked("player")?showPopupMsg(lang.LOCKED,800):sendMessage(E_COMMANDS.MEDIA_NEXT)};this.STOP=new Button(this);this.STOP.setImages(res.player_stop_off,res.player_stop_on);this.STOP.opaque=!1;this.STOP.disabledHide=!1;this.STOP.getState=function(){this.disabled=0==getValue("var.present")};this.STOP.onPress=function(){EMULATE?showPopupMsg(lang.DEMO_VERSION):isBlocked("player")?showPopupMsg(lang.LOCKED,800):sendMessage(E_COMMANDS.MEDIA_STOP)};HAVE_REC&&(this.REC=new CheckBox(this),this.REC.setImages(res.player_rec_off,res.player_rec_on),this.REC.opaque=!1,this.REC.disabledHide=!1,this.REC.getState=function(){this.state=getValue("var.isRecording");this.disabled=0==getValue("var.present")||.5<getValue("var.recBusy")},this.REC.onToggle=function(){toggleRec()});this.PLISTS=new PLISTS(this);this.PLISTS.setPos(10,100);this.PLISTS.setSize(200,400);this.PLISTS.onSelect=function(){if(!EMULATE){var b=this.selItem();sendMessage(E_COMMANDS.MEDIA_GET_PLIST_TRACKS+"^"+b);a.FLIST.clearSelection();regUpdate(a)}};this.PLISTS.onDClick=function(){if(isBlocked("player"))showPopupMsg(lang.LOCKED,800);else{var a=this.selItem();null!=a&&0!=a.length&&sendMessage(E_COMMANDS.MEDIA_SWITCH_PLIST+"^"+a)}};this.PLISTS.getActiveItem=function(){var a=getValue("var.currentPlaylist"),a=this.items.indexOf(a);this.activeItemIdx=0<=a?a:-1};this.FLIST=new PLISTS(this);this.FLIST.label=lang.FILES;this.FLIST.setPos(410,100);this.FLIST.setSize(400,400);this.FLIST.plistName="";this.FLIST.onDClick=function(){if(isBlocked("player"))showPopupMsg(lang.LOCKED,800);else{var b=this.selItem();if(null!=b&&0!=b.length){var d=a.PLISTS.selItem();if(null==d||0==d.length)d=getValue("var.currentPlaylist");null!=d&&0!=d.length&&sendMessage(E_COMMANDS.MEDIA_SWITCH_TRACK+"^"+d+"^"+b)}}};this.FLIST.getActiveItem=function(){var a=getValue("var.currentPlaylist");this.plistName!=a?this.activeItemIdx=-1:(a=getValue("var.currentTrack"),this.activeItemIdx=this.items.indexOf(a))};if(EMULATE){var b=$A($R("TRACK A","TRACK Z"));this.PLISTS.setItems($A($R("PLIST A","PLIST Z")));this.FLIST.setItems(b)}
this.mutefx=new CHECKBUTTON(this);this.mutefx.text=lang.MUTE_FX;this.mutefx.color=this.mutefx.textColor=color.tvMuteFX;this.mutefx.textColor2=color.white;this.mutefx.w=85;this.mutefx.setAnchors(null,null,205,5);this.mutefx.getState=function(){this.state=checkBit(getValue("mgmask"),MUTEFX_BIT_IDX)?1:0};this.mutefx.onToggleUp=function(){mixerWidget.muteFX();regUpdate(slideOutWidget)};this.mutefx.onToggleDown=function(){mixerWidget.unMuteFX();regUpdate(slideOutWidget)};this.muteall=new CHECKBUTTON(this);this.muteall.text=lang.MUTE_ALL;this.muteall.color=this.muteall.textColor=color.tvMuteALL;this.muteall.textColor2=color.white;this.muteall.w=85;this.muteall.setAnchors(null,null,110,5);this.muteall.getState=function(){this.state=checkBit(getValue("mgmask"),MUTEALL_BIT_IDX)?1:0};this.muteall.onToggleUp=function(){mixerWidget.muteAll()};this.muteall.onToggleDown=function(){mixerWidget.cancelMuteAll()};this.CUE=new CHECKBUTTON(this);this.CUE.setAnchors(null,null,10,5);this.CUE.text=lang.CUE;this.CUE.w=90;this.CUE.getState=function(){this.state=getValue("settings.cue")?1:0};this.CUE.onToggle=function(){isBlocked("player")?showPopupMsg(lang.LOCKED,800):setValue("settings.cue",this.state?1:0)};this.SHUFFLE=new CHECKBUTTON(this);this.SHUFFLE.setAnchors(180,null,null,5);this.SHUFFLE.text=lang.SHUFFLE;this.SHUFFLE.w=90;this.SHUFFLE.regKey("settings.shuffle");this.SHUFFLE.regKey("settings.playMode");this.SHUFFLE.getState=function(){this.disabled=2>getValue("settings.playMode");this.state=getValue("settings.shuffle")?1:0};this.SHUFFLE.onToggle=function(){isBlocked("player")?showPopupMsg(lang.LOCKED,800):setValue("settings.shuffle",this.state?1:0)}},onShow:function(){this.updateLists()},updateLists:function(){if(!EMULATE){sendMessage(E_COMMANDS.MEDIA_GET_PLISTS);var a=this.PLISTS.selItem();null==a&&(a=getValue("var.currentPlaylist"));a&&sendMessage(E_COMMANDS.MEDIA_GET_PLIST_TRACKS+"^"+a)}},onHide:function(){},setStrip:function(){null!=this.strip&&this.unStrip();this.strip=mediaStrips[0];this.saveX=this.strip.x;this.saveEnabled=this.strip.enabled;this.strip.parent=this;this.strip.updateGeometry();this.strip.enabled=!0;this.strip.x=0;this.strip.needClip=!0;this.widgets.push(this.strip)},unStrip:function(){null!=this.strip&&(this.widgets.pop(),this.strip.parent=mixerWidget,this.strip.enabled=this.saveEnabled,this.strip.needClip=!1,this.strip.calcGeometry=function(){this.h=this.parent.h},this.strip.updateGeometry(),this.strip.x=this.saveX,this.strip=null)},calcGeometry:function(){this.SWITCH.setPos(10,21);this.SEEKBAR.w=this.w-this.SEEKBAR.x-10;var a=(this.w-this.PREV.w-this.PLAY.w-this.NEXT.w-this.STOP.w-this.REC.w-6)/2|0;this.TIME.setPos(this.w-this.TIME.w-10,10);this.PREV.setPos(a,15);this.PLAY.setPos(this.PREV.x+this.PREV.w+2,15);this.STOP.setPos(this.PLAY.x+this.PLAY.w+2,15);this.NEXT.setPos(this.STOP.x+this.STOP.w+2,15);HAVE_REC&&this.REC.setPos(this.NEXT.x+this.NEXT.w+2+6,15);a=this.h-this.PLISTS.y-10-32;this.PLISTS.setSize(700<this.w?300:270,a);this.FLIST.x=this.PLISTS.x+this.PLISTS.w+2;this.FLIST.setSize(this.w-this.FLIST.x-10,a)},paint:function(){ctx.fillStyle=color.eqBg;ctx.fillRect(0,0,this.w,this.h)}}),BM_MTK_PLAY=Class.create(Widget,{initialize:function($super,b){$super(b);this.widgetName="BM_MTK_REC";this.color=color.yellow;this.regKey("var.mtk.present");this.initWidgets();mtkPlay=this},onShow:function(){this.updateLists()},updateLists:function(){EMULATE||(sendMessage(E_COMMANDS.MTK_GET_SESSIONS),sendMessage(E_COMMANDS.MTK_GET_FILES))},initWidgets:function(){var a=this;this.regKey("var.mtk.rec.busy");this.overview=new MENUBUTTON(this);this.overview.text=lang.OVERVIEW;this.overview.color=this.overview.textColor="#e44";this.overview.setPos(10,15);this.overview.setSize(100,40);this.overview.onPress=function(){settingsWidget.setMode(4);setMode(E_MODE.SETTINGS);settingsWidget.pages[4].setSrc(2);settingsWidget.pages[4].setMode(0)};this.scheck=new CHECKBUTTON(this);this.scheck.setAnchors(120,15);this.scheck.setSize(101,40);this.scheck.text=formatButtonText(lang.ACTIVATE_SOUNDCHECK);this.scheck.textColor=this.scheck.color=color.green;this.scheck.textColor2=color.white;this.scheck.setKey("var.mtk.soundcheck");this.scheck.regKey("var.mtk.soundcheck");this.scheck.onToggle=function(){updateByKey("var.mtk.soundcheck");regUpdate(a)};this.PLAY=new CheckBox(this);this.PLAY.setImages(res.player_play,res.player_pause);this.PLAY.setAnchors(null,15,266,null);this.PLAY.regKey("var.mtk.currentState");this.PLAY.regKey("var.mtk.rec.currentState");this.PLAY.regKey("var.mtk.present");this.PLAY.opaque=!1;this.PLAY.disabledHide=!1;this.PLAY.getState=function(){this.state=2==getValue("var.mtk.currentState")?1:0;this.disabled=0==getValue("var.mtk.present")||.5<getValue("var.mtk.rec.busy")||.5<getValue("var.mtk.rec.currentState")};this.PLAY.onToggleUp=function(){if(isBlocked("player"))showPopupMsg(lang.LOCKED,800);else{var a=getValue("var.mtk.rec.busy");.5<a&&2>a?showPopupMsg(lang.ERR_BUSYBUFFER):sendMessage(E_COMMANDS.MTK_PLAY)}};this.PLAY.onToggleDown=function(){isBlocked("player")?showPopupMsg(lang.LOCKED,800):sendMessage(E_COMMANDS.MTK_PAUSE)};this.STOP=new Button(this);this.STOP.setImages(res.player_stop_off,res.player_stop_on);this.STOP.setAnchors(null,15,194,null);this.STOP.regKey("var.mtk.rec.currentState");this.STOP.regKey("var.mtk.present");this.STOP.opaque=!1;this.STOP.disabledHide=!1;this.STOP.getState=function(){this.disabled=0==getValue("var.mtk.present")||.5<getValue("var.mtk.rec.busy")||.5<getValue("var.mtk.rec.currentState")};this.STOP.onPress=function(){if(isBlocked("player"))showPopupMsg(lang.LOCKED,800);else{var a=getValue("var.mtk.rec.busy");.5<a&&2>a?showPopupMsg(lang.ERR_BUSYBUFFER):(sendMessage(E_COMMANDS.MTK_STOP),.5<getValue("var.mtk.rec.currentState")&&showPopupMsg(lang.MTK_USB_REMOVE_WARNING))}};this.REC=new CheckBox(this);this.REC.setImages(res.player_rec_off,res.player_rec_on);this.REC.setAnchors(null,15,116,null);this.REC.regKey("var.mtk.rec.currentState");this.REC.regKey("var.mtk.currentState");this.REC.regKey("var.mtk.present");this.REC.opaque=!1;this.REC.disabledHide=!1;this.REC.getState=function(){this.state=getValue("var.mtk.rec.currentState");this.disabled=0==getValue("var.mtk.present")||.5<getValue("var.mtk.rec.busy")||0!=getValue("var.mtk.currentState")};this.REC.onToggle=toggleMTKRec;this.TIME=new MTK_TIME(this);this.TIME.setAnchors(null,10,10,null);this.SEEKBAR=new SEEKBAR(this);this.SEEKBAR.setAnchors(10,66,10,null);this.SEEKBAR.setKey("var.mtk.currentTrackPos",!0);this.SEEKBAR.onChange=function(a){isBlocked("player")?showPopupMsg(lang.LOCKED,800):sendMessage(E_COMMANDS.MTK_JUMP_TO+"^"+a)};this.cap_a=new Label(this);this.cap_a.font="15px open_sans_condensedbold";this.cap_a.color="#88b";this.cap_a.setAnchors(390,19,null,null);this.cap_a.w=110;this.cap_a.align="center";this.cap_a.regKey("var.mtk.freespace");this.cap_a.getState=function(){var a=getValue("var.mtk.freespace");this.text=0>a?lang.NOT_AVAILABLE:""+formatValue(a,2," "+lang.GB,!1)};this.buffer=new BufferLine(this);this.buffer.setAnchors(390,46,null,null);this.buffer.setKey("var.mtk.bufferfill",!0);this.sessions=new PLISTS(this);this.sessions.setAnchors(10,100,null,98);this.sessions.setSize(160,400);this.sessions.label=lang.SESSIONS;this.sessions.regKey("var.mtk.playsession");this.sessions.regKey("var.mtk.session");this.sessions.activeTextColor="#2a2";EMULATE&&(this.sessions.setItems($A($R("SESSION A","SESSION C"))),this.sessions.select(0));EMULATE||(this.sessions.onSelect=function(){if(!isBlocked("player")){var a=this.selItem();a&&sendMessage(E_COMMANDS.MTK_SET_SESSION+"^"+a)}},this.sessions.getState=function(){var a=getValue("var.mtk.session");this.selectedIdx=this.selected=a=this.items.indexOf(a);this.selectedItem=this.items[a]});this.sessions.getActiveItem=function(){var a=getValue("var.mtk.playsession");this.activeItemIdx=this.items.indexOf(a)};this.renam=new MENUBUTTON(this);this.renam.text=lang.RENAME_SESSION;this.renam.setAnchors(10,null,null,53);this.renam.setSize(160,40);this.renam.opaque=!1;this.renam.onPress=function(){var b=a.sessions.selItem();b&&(editOk.valueFunc=function(){var a=editBox2.value;a&&b!=a&&sendMessage(E_COMMANDS.MTK_REN_SESSION+"^"+b+"^"+a)},showEditBox2(lang.RENAME+" '"+b+"'",b))};this.delet=new MENUBUTTON(this);this.delet.text=lang.DELETE_SESSION;this.delet.setAnchors(10,null,null,9);this.delet.setSize(160,40);this.delet.regKey("var.mtk.currentState");this.delet.regKey("var.mtk.rec.currentState");this.delet.opaque=!1;this.delet.getState=function(){this.dimmed=!!getValue("var.mtk.rec.currentState")||!!getValue("var.mtk.currentState")};this.delet.onPress=function(){var b=a.sessions.selItem();b&&(confOk.valueFunc=function(){sendMessage(E_COMMANDS.MTK_DEL_SESSION+"^"+b)},showConfBox(lang.DELETE+" '"+b+"'?"))};this.patch=new PLISTS(this);this.patch.setAnchors(172,100,null,10);this.patch.setSize(160,400);this.patch.regKey("var.mtk.soundcheck");this.patch.label=lang.MIXER_PATCH;this.patch.maxTextLengthAuto=!1;this.patch.font="12pt open_sans_condensedbold";this.patch.setItems(Array(22));this.patch.getState=function(){for(var a=getValue("var.mtk.soundcheck"),b=[],c=0;22>c;c++){for(var g="",h="ua."+c,k=0,m=allStrips.length;k<m;k++){var l=allStrips[k];l.getNameValue(a?"scsrc":"src")==h&&(g+=l.getLabel()+" ")}
g||(g="---");g=""+(c+1)+(9>c?" ":"")+" : "+g;18>g.length&&(g=lang.SLOT+(9>c?"  ":" ")+g);b.push(g)}
this.items=b};this.patch.onDClick=function(){var a=inStrips.concat(lineinStrips).filter(function(a){return 20>a.subId}),a=new CH_SEL_POPUP(a);a.slot=this.selectedIdx;a.valueFunc=function(a){var b=getValue("var.mtk.soundcheck"),c="src";b&&(c="scsrc");for(var d=0;d<this.arr.length;d++){var e=this.arr[d],m=e.getNameValue(c),l="ua."+this.slot;(!b&&m==l||b&&m==l&&-1==a)&&e.setNameValue(c,"none")}-1!=a&&this.arr[a].setNameValue(c,"ua."+this.slot)}};this.files=new PLISTS(this);this.files.setAnchors(334,100,10,10);this.files.label=lang.FILES;this.files.noSelection=!0;if(EMULATE){for(var b=[],c=0;22>c;c++)b.push("Track_"+(c+1)+".wav");this.files.setItems(b,!1)}},calcGeometry:function(){},paint:function(){ctx.fillStyle=color.eqBg;ctx.fillRect(0,0,this.w,this.h);var a=this.cap_a.x-10;ctx.drawText(lang.SPACE_REMAINING+":",a,29,{font:"15px open_sans_condensedbold",color:color.white,align:"right",valign:"middle"});ctx.drawText(lang.BUFFER+":",a,50,{font:"15px open_sans_condensedbold",color:color.white,align:"right",valign:"middle"});CASCADE_MODE&&ctx.drawText(lang.REMOTE+":",a,50,{font:"15px open_sans_condensedbold",color:color.white,align:"right",valign:"middle"})}}),CustomSlideOut2=Class.create(SlideOut2,{initialize:function($super,b){$super(b);this.widgetName="CustomSlideOut2";this.y=measures.topWidgetHeight;this.w=2*measures.mixerStripWidth;this.view=0;this.color="#1593C0";this.cachedStrip=null;this.cachedStripHeight=0;this.condensed=740>Math.min(screenHeight,screenWidth);this.initWidgets();this.mode=0;this.enabled=!1},setView:function(a){this.view=a;this.BANKS_B.each(function(a){a.hide()});this.PLAYER_B.each(function(a){a.hide()});this.FUNCS_B.each(function(a){a.hide()});switch(a){case 0:this.BANKS_B.each(function(a){a.show()});break;case 1:this.PLAYER_B.each(function(a){a.show()});IS_UI_24||(this.mtkpl.hide(),this.mtkrec.hide());break;case 2:this.FUNCS_B.each(function(a){a.show()})}
regUpdate(this)},calcGeometry:function(){this.x=screenWidth-this.w;this.y=topWidget.enabled?topWidget.h:0;mode==E_MODE.BIG&&(this.y=measures.topWidgetHeight+BM_TOP_H);this.h=screenHeight-this.y},clearGotoButtons:function(){regUpdate(this)},clearViewButtons:function(){regUpdate(this)},setMode:function(a){this.mode=a;regUpdate(this)},nextMode:function(){for(var a=this.view+1;a<this.buttons.length;a++)
if(this.buttons[a].enabled){this.buttons[a].click();return}
for(a=0;a<this.view;a++)this.buttons[a].enabled&&this.buttons[a].click()},onShow:function(){this.startBPM();this.gain&&(mode!=E_MODE.BIG?(this.udp.disabled=!0,this.gain.disabled=!0,this.eqdyn.disabled=!0,this.sends.disabled=!0,this.info.disabled=!0):(this.udp.disabled=!1,this.gain.disabled=!1,this.eqdyn.disabled=!1,this.sends.disabled=!1,this.info.disabled=!1));mode==E_MODE.BIG&&(settings.udp?this.udp.show():this.udp.hide())},onHide:function(){this.stopBPM()},startBPM:function(){this.bpmTimer=null;this.calcBPM()},calcBPM:function(){var a=getGlobalBpm(!0);this.lastbpmValue=a;this.beepTime=6E4/a;80>this.beepTime&&(this.beepTime=80);3E3<this.beepTime&&(this.beepTime=3E3);1>a&&(this.beepTime=500);setTimeout(this.beginBPM.bind(this),Util.getBpmSyncOffset(this.beepTime))},beginBPM:function(){var a=this;clearInterval(this.bpmTimer);this.bpmTimer=setInterval(function(){var b=getGlobalBpm(!0);1<b&&a.tap.doBeep();b!=a.lastbpmValue&&a.calcBPM()},this.beepTime)},stopBPM:function(){clearInterval(this.bpmTimer);this.lastbpmValue=-1},initWidgets:function(){var a=this,b=6,c=7;this.banks=new CHECKBUTTON(this);this.banks.text=lang.BANKS;this.banks.setAnchors(c,b);this.banks.w=65;this.banks.color="#1FC8F2";this.banks.bgColor="#2555A4";this.banks.strokeColor="#1AA6C9";this.banks.textColor="#e9e9f9";this.banks.idx=0;this.banks.getState=function(){this.state=a.view==this.idx};this.banks.onToggleUp=function(){a.setView(this.idx)};this.player=new CHECKBUTTON(this);this.player.setAnchors(c+this.banks.w+2,b);this.player.w=65;this.player.text=lang.PLAYER;this.player.color="#1FC8F2";this.player.bgColor="#2555A4";this.player.strokeColor="#1AA6C9";this.player.textColor="#e9e9f9";this.player.idx=1;this.player.getState=function(){this.state=a.view==this.idx};this.player.onToggleUp=function(){a.setView(this.idx)};this.funcs=new CHECKBUTTON(this);this.funcs.setAnchors(c+this.banks.w+2+this.player.w+2,b);this.funcs.w=76;this.funcs.text=lang.FUNCTIONS;this.funcs.color="#1FC8F2";this.funcs.bgColor="#2555A4";this.funcs.strokeColor="#1AA6C9";this.funcs.textColor="#e9e9f9";this.funcs.idx=2;this.funcs.getState=function(){this.state=a.view==this.idx};this.funcs.onToggleUp=function(){a.setView(this.idx)};this.buttons=[this.banks,this.player,this.funcs];var b=50,d=41,c=40;this.BANKS_B=[];this.PLAYER_B=[];this.FUNCS_B=[];c=41;this.bank_l=new TButton(this);this.bank_l.setAnchors(c,b+d+1);this.bank_l.setImages(res.FFUNC_B_OFF,res.FFUNC_B_YLW);this.bank_l.text="<";this.bank_l.onPress=function(){bottomWidget.goLeft()};this.bank_l.enabled=!1;this.bank_r=new TButton(this);this.bank_r.setAnchors(null,b+d+1,c);this.bank_r.setImages(res.FFUNC_B_OFF,res.FFUNC_B_YLW);this.bank_r.text=">";this.bank_r.onPress=function(){bottomWidget.goRight()};this.bank_r.enabled=!1;this.bank_s=new TButton(this);this.bank_s.setAnchors(c,b+1);this.bank_s.setImages(res.FFUNC_B_OFF,res.FFUNC_B_YLW);this.bank_s.text=lang.START;this.bank_s.onPress=function(){bottomWidget.gotoStart()};this.bank_s.enabled=!1;this.bank_e=new TButton(this);this.bank_e.setAnchors(null,b+1,c);this.bank_e.setImages(res.FFUNC_B_OFF,res.FFUNC_B_YLW);this.bank_e.text=lang.END;this.bank_e.onPress=function(){bottomWidget.gotoEnd()};this.bank_e.enabled=!1;this.BANKS_B.push(this.bank_l);this.BANKS_B.push(this.bank_r);this.BANKS_B.push(this.bank_s);this.BANKS_B.push(this.bank_e);c=40;this.pl=new CheckBox(this);this.pl.setAnchors(c,b+d);this.pl.setImages(res.PLAYS_OFF,res.PLAYS_STOP);this.pl.regKey("var.currentState");this.pl.regKey("var.present");this.pl.getState=function(){this.disabled=0==getValue("var.present");this.state=2==getValue("var.currentState")?1:0};this.pl.onToggle=function(){doFfunc(E_FFUNC.PLAY)};this.rec=new CheckBox(this);this.rec.setAnchors(null,b+d,c);this.rec.setImages(res.RECS_OFF,res.RECS_STOP);this.rec.regKey("var.recBusy");this.rec.regKey("var.isRecording");this.rec.regKey("var.present");this.rec.getState=function(){this.state=getValue("var.isRecording");this.disabled=0==getValue("var.present")||.5<getValue("var.recBusy")};this.rec.onToggle=function(){doFfunc(E_FFUNC.REC)};this.mtkpl=new CheckBox(this);this.mtkpl.setAnchors(c,b);this.mtkpl.setImages(res.MTK_PLAY,res.MTK_STOP);this.mtkpl.regKey("var.mtk.currentState");this.mtkpl.regKey("var.mtk.rec.currentState");this.mtkpl.regKey("var.mtk.rec.busy");this.mtkpl.regKey("var.mtk.present");this.mtkpl.getState=function(){this.state=2==getValue("var.mtk.currentState")?1:0;this.disabled=0==getValue("var.mtk.present")||.5<getValue("var.mtk.rec.busy")||.5<getValue("var.mtk.rec.currentState")};this.mtkpl.onToggle=function(){doFfunc(E_FFUNC.MTK_PLAY)};this.mtkrec=new CheckBox(this);this.mtkrec.setAnchors(null,b,c);this.mtkrec.setImages(res.MTK_REC_OFF,res.MTK_REC_ON);this.mtkrec.regKey("var.mtk.rec.currentState");this.mtkrec.regKey("var.mtk.rec.busy");this.mtkrec.regKey("var.mtk.currentState");this.mtkrec.regKey("var.mtk.present");this.mtkrec.getState=function(){this.state=getValue("var.mtk.rec.currentState");this.disabled=0==getValue("var.mtk.present")||.5<getValue("var.mtk.rec.busy")||0!=getValue("var.mtk.currentState")};this.mtkrec.onToggle=function(){doFfunc(E_FFUNC.MTK_REC)};this.PLAYER_B.push(this.pl);this.PLAYER_B.push(this.rec);this.PLAYER_B.push(this.mtkpl);this.PLAYER_B.push(this.mtkrec);this.newsnap=new Button(this);this.newsnap.setAnchors(null,b,c);this.newsnap.setImages(res.SS_OFF,res.SS_ON);this.newsnap.onPress=function(){doFfunc(E_FFUNC.NEWSNAP)};this.updsnap=new Button(this);this.updsnap.setAnchors(c,b);this.updsnap.setImages(res.SSUPD_OFF,res.SSUPD_ON);this.updsnap.onPress=function(){doFfunc(E_FFUNC.UPDCURSNAP)};this.nextsnap=new Button(this);this.nextsnap.setAnchors(null,b+d,c);this.nextsnap.setImages(res.NXT_SNP_OFF,res.NXT_SNP_ON);this.nextsnap.onPress=function(){doFfunc(E_FFUNC.NEXT_SNAP)};this.prevsnap=new Button(this);this.prevsnap.setAnchors(c,b+d);this.prevsnap.setImages(res.PRV_SNP_OFF,res.PRV_SNP_ON);this.prevsnap.onPress=function(){doFfunc(E_FFUNC.PREV_SNAP)};this.FUNCS_B.push(this.newsnap);this.FUNCS_B.push(this.nextsnap);this.FUNCS_B.push(this.updsnap);this.FUNCS_B.push(this.prevsnap);HAVE_CUE&&(this.newsnap.setAnchors(c-20,b),this.updsnap.setAnchors(c-20,b+d),this.nextsnap.setAnchors(85,b),this.prevsnap.setAnchors(85,b+d),this.nextcue=new Button(this),this.nextcue.setAnchors(null,b+1,c-21),this.nextcue.setImages(res.FFUNC_B_OFF,res.FFUNC_B_GRE),this.nextcue.text=lang.NEXT_CUE.replace(" ","\n"),this.nextcue.font="14px open_sans_condensedbold",this.nextcue.textColor=color.black2,this.nextcue.textColorActive=color.white,this.nextcue.shadowColorActive="#333",this.nextcue.shadowColor="#ccc",this.nextcue.textParam={font:"14px open_sans_condensedbold",x:null,y:null,offsetX:-1,offsetY:-3,pressOffsetX:0,pressOffsetY:1,align:"center",valign:"middle",shadow:["#ccc",0,1,1],dy:12},this.nextcue.onPress=function(){doFfunc(E_FFUNC.NEXT_CUE)},this.prevcue=new Button(this),this.prevcue.setAnchors(null,b+d+1,c-21),this.prevcue.setImages(res.FFUNC_B_OFF,res.FFUNC_B_GRE),this.prevcue.text=lang.PREV_CUE.replace(" ","\n"),this.prevcue.font="14px open_sans_condensedbold",this.prevcue.textColor=color.black2,this.prevcue.textColorActive=color.white,this.prevcue.shadowColorActive="#333",this.prevcue.shadowColor="#ccc",this.prevcue.textParam={font:"14px open_sans_condensedbold",x:null,y:null,offsetX:-1,offsetY:-3,pressOffsetX:0,pressOffsetY:1,align:"center",valign:"middle",shadow:["#ccc",0,1,1],dy:12},this.prevcue.onPress=function(){doFfunc(E_FFUNC.PREV_CUE)},this.FUNCS_B.push(this.nextcue),this.FUNCS_B.push(this.prevcue));this.PLAYER_B.each(function(a){a.hide()});this.FUNCS_B.each(function(a){a.hide()});settings.bigD&&(c=16,b=173,d=43,this.gain=new CheckBox(this),this.gain.setPos(c,b),this.gain.setImages(res.SO_M_BTN_OFF,res.SO_M_BTN_TUR),this.gain.text=lang.GAIN,this.gain.textParam.offsetY=-3,this.gain.getState=function(){this.state=0==bmMode},this.gain.onToggleUp=function(){setBMode(0)},this.eqdyn=new CheckBox(this),this.eqdyn.setPos(c,b+=d),this.eqdyn.setImages(res.SO_M_BTN_OFF,res.SO_M_BTN_TUR),this.eqdyn.text=lang.DYN+" / "+lang.EQ,this.eqdyn.textParam.offsetY=-3,this.eqdyn.getState=function(){this.state=1==bmMode},this.eqdyn.onToggleUp=function(){setBMode(1)},this.sends=new CheckBox(this),this.sends.setPos(c+104,b-d),this.sends.setImages(res.SO_M_BTN_OFF,res.SO_M_BTN_TUR),this.sends.text=lang.SENDS,this.sends.textParam.offsetY=-3,this.sends.getState=function(){this.state=2==bmMode},this.sends.onToggleUp=function(){setBMode(2)},this.info=new CheckBox(this),this.info.setPos(c+104,b),this.info.setImages(res.SO_M_BTN_OFF,res.SO_M_BTN_TUR),this.info.text=lang.INFO,this.info.textParam.offsetY=-3,this.info.getState=function(){this.state=4==bmMode},this.info.onToggleUp=function(){setBMode(4)},this.udp=new CheckBox(this),this.udp.setPos(c,b+=d),this.udp.setImages(res.SO_M_BTN_OFF,res.SO_M_BTN_TUR),this.udp.text=lang.UDP,this.udp.textParam.offsetY=-3,this.udp.getState=function(){this.state=3==bmMode},this.udp.onToggleUp=function(){setBMode(3)},this.udp.hide(),this.custom=new CheckBox(this),this.custom.setPos(c+104,b),this.custom.setImages(res.SO_M_BTN_OFF,res.SO_M_BTN_TUR),this.custom.text=lang.PLAYER,this.custom.textParam.offsetY=-3,this.custom.getState=function(){this.state=5==bmMode},this.custom.onToggleUp=function(){setBMode(5)});c=16;b=164;this.condensed&&(b=158);settings.bigD&&(b+=165);d=40;settings.bigD&&(d=42);this.MGS=[];this.VGS=[];for(var e=0;6>e;e++){var f=new CheckBox(this);f.setImages(res.SO_M_BTN_OFF,res.SO_M_BTN_TUR);f.setPos(c,b+d*e);f.idx=e;f.clickOnUp=!0;f.longClickMark=!0;f.textParam.offsetY=-3;f.textParam.font="11pt open_sans_condensedbold";f.text="NAMED GROUP "+e;f.getState=function(){var a=0==getVG(this.idx).length;this.state=activeViewGroup==this.idx?1:0;this.text=getVGName(this.idx)||lang.VIEW_GROUP+" "+(this.idx+1);13<this.text.length&&(this.text=cropText(this.text,12));this.textColor=a?color.gray:color.vgText};f.onToggleUp=function(){0==getVG(this.idx).length?(showPopupMsg(lang.NO_ASSIGNED_VIEWGROUP.format(this.idx+1),800),this.state=0):mixerWidget.showViewGroup(this.idx)};f.onToggleDown=function(){mixerWidget.showAll()};f.onHold=function(){modalsWidget.setMode(E_MODAL_MODE.VIEWS);modalsWidget.pages[E_MODAL_MODE.VIEWS].setMode(this.idx);setMode(E_MODE.MODALS)};this.MGS.push(f);f=new CheckBox(this);f.setImages(res.SO_M_BTN_OFF,res.SO_M_BTN_RED);f.setPos(c+104,b+d*e);f.idx=e;f.clickOnUp=!0;f.longClickMark=!0;f.textParam.offsetY=-3;f.textParam.font="11pt open_sans_condensedbold";f.text="NAMED GROUP "+e;f.getState=function(){var a=muteGroupEmpty(this.idx);this.state=getMGroupState(this.idx);this.text=getValue("mg."+this.idx+".name")||lang.MUTE+" "+(this.idx+1);13<this.text.length&&(this.text=cropText(this.text,12));this.textColor=a?color.gray:color.mgText};f.onToggleUp=function(){muteGroupON(this.idx)};f.onToggleDown=function(){muteGroupOFF(this.idx)};f.onHold=function(){modalsWidget.setMode(E_MODAL_MODE.MUTES);modalsWidget.pages[E_MODAL_MODE.MUTES].setMode(this.idx);setMode(E_MODE.MODALS)};this.VGS.push(f)}
b=432;this.condensed&&(b=420);b=settings.bigD?b+183:b-13;this.mutefx=new CheckBox(this);this.mutefx.setPos(c,b);this.mutefx.setImages(res.SO_M_BTN_OFF,res.SO_M_BTN_BLU);this.mutefx.text=lang.MUTE_FX;this.mutefx.textParam.offsetY=-3;this.mutefx.textParam.font="12pt open_sans_condensedbold";this.mutefx.getState=function(){this.state=checkBit(getValue("mgmask"),MUTEFX_BIT_IDX)?1:0};this.mutefx.onToggleUp=function(){mixerWidget.muteFX();if(typeof bmCustom!=='undefined'){regUpdate(bmCustom.player.mutefx)}};this.mutefx.onToggleDown=function(){mixerWidget.unMuteFX();if(typeof bmCustom!=='undefined'){regUpdate(bmCustom.player.mutefx)}};this.tap=new Button(this);this.tap.setAnchors(null,b,c);this.tap.lastTapTime=0;this.tap.longClickMark=!0;this.tap.textParam.offsetY=-3;this.tap.setImages(res.SO_M_BTN_OFF,res.SO_M_BTN_RED);this.tap.text=lang.TAP_TEMPO;this.tap.valueFunc=bpmTapHandler;this.tap.onHold=askBpm;this.tap.opaque=!1;this.tap.textParam.font="12pt open_sans_condensedbold";this.tap.doBeep=function(){var a=this;this.longClickMarkColor="#2ee";this.longClickMarkColor2="#066";regUpdate(this);clearTimeout(this.beepTimer);this.beepTimer=setTimeout(function(){a.longClickMarkColor=color.longClickMark;a.longClickMarkColor2=color.longClickMark2;regUpdate(a)},80)};b+=47;this.clearsolo=new Button(this);this.clearsolo.setImages(res.SO_M_BTN_OFF,res.SO_M_BTN_RED);this.clearsolo.setAnchors(c,b,null,null);this.clearsolo.text=lang.CLEAR_SOLO;this.clearsolo.textColor="#D6C560";this.clearsolo.textParam.offsetY=-3;this.clearsolo.textParam.font="12pt open_sans_condensedbold";this.clearsolo.onPress=function(){mixerWidget.clearSolos();regUpdate(a)};this.clearmute=new Button(this);this.clearmute.setImages(res.SO_M_BTN_OFF,res.SO_M_BTN_RED);this.clearmute.setAnchors(null,b,c,null);this.clearmute.text=lang.CLEAR_MUTE;this.clearmute.textColor="#D66D60";this.clearmute.textParam.offsetY=-3;this.clearmute.textParam.font="12pt open_sans_condensedbold";this.clearmute.onPress=function(){mixerWidget.clearMutes();regUpdate(a)};b=539;this.condensed&&(b=513);settings.bigD&&(b+=207);this.inp=new CheckBox(this);this.inp.setImages(res.SO_B_BTN_OFF,res.SO_B_BTN_YLW);this.inp.setAnchors(c,b);this.inp.text=lang.INPUTS;this.inp.textColor=color.INPUT;this.inp.idx=E_VG.INPUTS;this.inp.textParam.offsetY=-3;this.inp.textParam.font="12pt open_sans_condensedbold";this.inp.getState=function(){this.state=activeViewGroup==this.idx?1:0};this.inp.onToggleUp=function(){mode!=E_MODE.MIX&&setMode(E_MODE.MIX);mixerWidget.showInputsGroup()};this.inp.onToggleDown=function(){resumeLastActiveVG()};this.inp.hide();this.fx=new CheckBox(this);this.fx.setImages(res.AUXM_OFF,res.AUXM_ON);this.fx.setAnchors(c,b);this.fx.textColor="#76A8D6";this.fx.text=formatButtonText(lang.FX_MASTERS);this.fx.textParam.font="12pt open_sans_condensedbold";this.fx.textParam.offsetX=-1;this.fx.textParam.offsetY=-4;this.fx.idx=E_VG.FXS;this.fx.getState=function(){this.state=activeViewGroup==this.idx?1:0};this.fx.onToggleUp=function(){mode!=E_MODE.MIX&&setMode(E_MODE.MIX);mixerWidget.showFxGroup()};this.fx.onToggleDown=function(){resumeLastActiveVG()};this.fx.contains=function(b,c){if(!this.enabled||!this.visible)return!1;var d=b-a.home.x,e=c-a.home.y,f=a.home.w/2,g=a.home.h/2;return this.enabled&&this.visible?this.x<=b&&this.x+this.w>b&&this.y<=c&&this.y+this.h>c&&!isInCircle(f,g,24,d,e):!1};this.sub=new CheckBox(this);this.sub.setImages(res.FXM_OFF,res.FXM_ON);this.sub.setAnchors(null,b,c);this.sub.textColor="#D8A5B9";this.sub.textParam.font="12pt open_sans_condensedbold";this.sub.textParam.offsetX=1;this.sub.textParam.offsetY=-4;this.sub.idx=E_VG.SUBS;this.sub.text=formatButtonText(lang.SUB_GROUPS);this.sub.getState=function(){this.state=activeViewGroup==this.idx?1:0};this.sub.onToggleUp=function(){mode!=E_MODE.MIX&&setMode(E_MODE.MIX);mixerWidget.showSubGroup()};this.sub.onToggleDown=function(){resumeLastActiveVG()};this.sub.onHold=function(){modalsWidget.setMode(E_MODAL_MODE.SUBS);setMode(E_MODE.MODALS)};this.sub.contains=function(b,c){if(!this.enabled||!this.visible)return!1;var d=b-a.home.x,e=c-a.home.y,f=a.home.w/2,g=a.home.h/2;return this.enabled&&this.visible?this.x<=b&&this.x+this.w>b&&this.y<=c&&this.y+this.h>c&&!isInCircle(f,g,24,d,e):!1};this.aux=new CheckBox(this);this.aux.setImages(res.SUBG_OFF,res.SUBG_ON);this.aux.setAnchors(c,b+71);this.aux.textColor="#DBCB7A";this.aux.textParam.font="12pt open_sans_condensedbold";this.aux.textParam.offsetX=-1;this.aux.textParam.offsetY=-4;this.aux.idx=E_VG.AUXS;this.aux.text=formatButtonText(lang.AUX_MASTERS);this.aux.getState=function(){this.state=activeViewGroup==this.idx?1:0};this.aux.onToggleUp=function(){mode!=E_MODE.MIX&&setMode(E_MODE.MIX);mixerWidget.showAuxGroup()};this.aux.onToggleDown=function(){resumeLastActiveVG()};this.aux.contains=function(b,c){if(!this.enabled||!this.visible)return!1;var d=b-a.home.x,e=c-a.home.y,f=a.home.w/2,g=a.home.h/2;return this.enabled&&this.visible?this.x<=b&&this.x+this.w>b&&this.y<=c&&this.y+this.h>c&&!isInCircle(f,g,24,d,e):!1};this.vca=new CheckBox(this);this.vca.setImages(res.VCA_OFF,res.VCA_ON);this.vca.setAnchors(null,b+71,c);this.vca.textColor="#8BD08B";this.vca.textParam.font="12pt open_sans_condensedbold";"cn"==settings.lang&&(this.vca.textParam.font="11pt open_sans_condensedbold");this.vca.textParam.offsetX=1;this.vca.textParam.offsetY=-4;this.vca.idx=E_VG.VCAS;this.vca.text=formatButtonText(lang.VCA_MASTERS);IS_UI_24||(this.vca.text=formatButtonText(lang.INPUTS),this.vca.idx=E_VG.INPUTS);this.vca.getState=function(){this.state=activeViewGroup==this.idx?1:0};this.vca.onToggleUp=function(){mode!=E_MODE.MIX&&setMode(E_MODE.MIX);IS_UI_24?mixerWidget.showVCAGroup():mixerWidget.showInputsGroup()};this.vca.onToggleDown=function(){resumeLastActiveVG()};this.vca.contains=function(b,c){if(!this.enabled||!this.visible)return!1;var d=b-a.home.x,e=c-a.home.y,f=a.home.w/2,g=a.home.h/2;return this.enabled&&this.visible?this.x<=b&&this.x+this.w>b&&this.y<=c&&this.y+this.h>c&&!isInCircle(f,g,24,d,e):!1};this.home=new Button(this);this.home.setImages(res.HOME_OFF,res.HOME_ON);this.home.setAnchors(c+71,b+37);this.home.contains=function(a,b){return this.enabled&&this.visible?isInCircle(this.w/2,this.h/2,24,a-this.x,b-this.y):!1};this.home.onPress=function(){mode!=E_MODE.MIX&&setMode(E_MODE.MIX);mixerWidget.showAll()}},paint:function(){this.cachedStripHeight!=this.h&&this.cachePaint();ctx.drawImage(this.cachedStrip,0,0,this.w,this.h);this.banks.enabled&&(ctx.fillStyle="#1FC8F2",ctx.fillRect(7,this.banks.y+this.banks.h+1,this.w-14,3));settings.bigD&&this.drawHeader(lang.EDIT_VIEW,this.gain.y-18,ctx)},drawHeader:function(a,b,c){c.font="12pt open_sans_condensedbold";var d=c.measureText(a).width,e=this.w,d=(e-d-20-34)/2|0;a&&0!=a.length||(d=(e-34)/2);c.fillStyle="#0A1957";c.fillRect(17,b-2,d,2);c.fillRect(this.w-17,b-2,-d,2);c.fillStyle="#3A88E1";c.fillRect(17,b,d,1);c.fillRect(this.w-17,b,-d,1);a&&0!=a.length&&c.drawText(a,this.w/2,b+10-6,{shadow:[color.black,0,1,1],color:"#E0E0E0",align:"center",font:"12pt open_sans_condensedbold"})},cachePaint:function(){null!=this.cachedStrip&&delete this.cachedStrip;this.cachedStrip=document.createElement("canvas");var a=this.cachedStrip.getContext("2d");isRetina?(this.cachedStrip.width=2*this.w,this.cachedStrip.height=2*this.h,a.scale(2,2)):(this.cachedStrip.width=this.w,this.cachedStrip.height=this.h);a.fillStyle="#2353A2";a.fillRect(0,0,this.w,this.h);fillVertPatternCtx(res.SO2_TILE,this.h,a);drawImageCtx(res.SO2_BOTTOM,0,this.h-res.soBottom.h(),a);drawImageCtx(res.SO2_TOP,0,0,a);a.fillStyle="#010101";a.fillRect(0,this.h-1,this.w,1);if(settings.bigD)this.drawHeader(lang.GROUPS,this.MGS[0].y-18,a),this.drawHeader(lang.MASTERS,this.fx.y-18,a),this.drawHeader("",this.mutefx.y-22,a);else if(this.condensed){var b=144;settings.bigD&&(b-=144);settings.bigD||this.drawHeader(lang.GROUPS,b,a);b=500;settings.bigD&&(b-=144);this.drawHeader(lang.MASTERS,b,a)}else this.drawHeader(lang.GROUPS,this.MGS[0].y-16,a),this.drawHeader(lang.MASTERS,this.fx.y-16,a),this.drawHeader("",this.mutefx.y-10,a);this.cachedStripHeight=this.h}});function setBMode(a){bmMode=a;if(mode==E_MODE.BIG){gainMixer.hide();bmEqdyn.hide();bmSends.hide();bmUdp.hide();infoMixer.hide();infoMaster.hide();bmCustom.hide();switch(a){case 0:gainMixer.show();break;case 1:bmEqdyn.show();break;case 2:bmSends.show();break;case 3:bmUdp.show();break;case 4:infoMaster.show(),infoMixer.show();break;case 5:bmCustom.show()}
drawAll()}};function setMode(a,b){settings.bigD&&a==E_MODE.MIX&&(a=E_MODE.BIG);log("=== "+objKeyByValue(E_MODE,mode)+" -> "+objKeyByValue(E_MODE,a));if(null!=mixerWidget){if(isPortrait)switch(a){case E_MODE.MIX:case E_MODE.BIG:case E_MODE.GAIN:case E_MODE.AUX:case E_MODE.FXSENDS:case E_MODE.MOREME:break;default:return}
lastMode=mode;modeHistory.push(mode);mode=a;clearInterval(ticker);for(var c=0;c<widgets.length;c++)widgets[c].hide();topWidget.show();masterWidget.show();bottomWidget.show();mixerWidget.mode!=E_MODE.MIX&&mixerWidget.setMode(E_MODE.MIX);switch(a){case E_MODE.UDP:masterWidget.hide();bottomWidget.hide();udpPage.show();break;case E_MODE.BIG:bmMeters.show();switch(bmMode){case 0:gainMixer.show();break;case 1:bmEqdyn.show();break;case 2:bmSends.show();break;case 3:bmUdp.show();break;case 4:infoMaster.show(),infoMixer.show()
case 5:bmCustom.show()}
slideOutWidget.show();mixerWidget.show();break;case E_MODE.MIX:mixerWidget.show();settings.masterHide&&masterWidget.hide();if(settings.pinSlideOut||isDefined(b)&&2!=b)settings.masterHide&&masterWidget.show(),slideOutWidget.show();break;case E_MODE.GAIN:settings.masterHide&&masterWidget.hide();gainMixer.show();break;case E_MODE.EDIT:editStripWidget.show();editWidget.show();break;case E_MODE.AUX:settings.masterHide&&masterWidget.hide();if(settings.pinSlideOutX||isDefined(b)&&2!=b)settings.masterHide&&masterWidget.show(),slideOutWidget.show();auxoutWidget.show();auxWidget.show();break;case E_MODE.FXSENDS:settings.masterHide&&masterWidget.hide();if(settings.pinSlideOutX||isDefined(b)&&2!=b)settings.masterHide&&masterWidget.show(),slideOutWidget.show();fxSendsWidget.show();fxoutWidget.show();break;case E_MODE.SETTINGS:masterWidget.hide();bottomWidget.hide();settingsWidget.show();break;case E_MODE.MODALS:bottomWidget.hide();modalsWidget.show();break;case E_MODE.PLAYER:bottomWidget.hide();playerWidget.show();IS_UI_24?0==playerWidget.mode&&(playerStrips.show(),playerLabels.show()):(playerStrips.show(),playerLabels.show());break;case E_MODE.PONG:pongGame.show();break;case E_MODE.MOREME:slideOutWidget.hide(),bottomWidget.hide(),masterWidget.hide(),isDefined(b)&&2==b&&topWidget.hide(),auxoutWidget.show(),moremeWidget.show()}
geomAll();bottomWidget.upd();drawAll("setMode("+objKeyByValue(E_MODE,a)+")")}};bmSlideout=null;settings.bigD&&(infoMixer=new InfoMixer,infoMaster=new InfoMasterStrip,bmEqdyn=new BM_EQDYN,bmSends=new BM_SENDS,bmMeters=new BM_METERS,bmUdp=new UDP_CUSTOM_PAGE2,bmCustom=new BM_CUSTOM);slideOutWidget=settings.bigSlideOut?new CustomSlideOut2:new SlideOut;slideOutWidget.setView(0);topWidget.bSet.onDown();topWidget.bSet.onDown()
